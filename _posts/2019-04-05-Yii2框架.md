---
title: Yii2框架
author: Yahui
layout: other
category: Other
---

《暂无》

<pre style="text-align: left;">
	<h1>Yii安装(composer)</h1>
	1、安装composer https://getcomposer.org/Composer-Setup.exe
	2、进入到项目目录(例如：phpstudy/WWW)
	3、因为默认composer安装包网址是国外镜像，会被防火墙屏蔽，所以修改镜像地址:
		composer config -g repo.packagist composer https://packagist.phpcomposer.com
	4、安装composer asset插件：
		composer global require "fxp/composer-asset-plugin:~1.4.0"(版本号可以查看最新)
	5、安装yii2basic版本：
		composer create-project --prefer-dist yiisoft/yii2-app-basic basic
		<span class="image featured"><img src="{{ 'assets/images/other/yii2diff.jpg' | relative_url }}" alt="" /></span>
	6、安装完毕可以正常访问web下的index.php(根目录的入口文件可以参考这个，但是路径要进行修改)
	7、根据开发环境修改config文件中web.php的常量来开启或者关闭gii与debug
	8、根目录添加重写文件.htaccess (或者可以根据index.php?r=gii)来访问gii
		Options +FollowSymLinks
		IndexIgnore */*
		RewriteEngine on

		# if a directory or a file exists, use it directly
		RewriteCond %{REQUEST_FILENAME} !-f
		RewriteCond %{REQUEST_FILENAME} !-d

		# otherwise forward it to index.php
		RewriteRule . index.php
	9、可以根据gii来创建模块地址并在web.php中配置添加的模块地址：
		'modules' => [
	        'admin' => [
	            'class' => 'app\modules\admin\Admin',
	        ],
        ],

    <span class="image featured"><img src="{{ 'assets/images/other/yiirequestline.jpg' | relative_url }}" alt="" /></span>
    
    表单使用ActiveForm创建，能够同时添加JS验证规则
    <?php $form = ActiveForm::begin(['id' => 'contact-form']); ?>
    	<?php echo $form->field($model, 'name')->textInput(['autofocus' => true]) ?>

    	<?php echo $form->field($model, 'password')->passwordinput() ?>

    	<?php echo $form->field($model, 'body')->textArea(['rows'=>6]) ?>

    	<?php echo $form->field($model, 'verifyCode')->widget(Captcha::className(), ['template' => '...html标签样式...{image}...html标签样式...{input}...html标签样式...',]) ?>

    	<?php echo $form->field($model,'username')->textinput()->hint('请输入你的姓名')->label('Name') ?>

    	<?php echo $form->field($model,'email')->input('email') ?>

    	// 如果需要一些不用绑定参数的标签，可以手动写HTML标签，也可以使用HTML帮助类来实现
    	<?php echo Html::submitButton('Submit', ['class' => 'btn btn-primary', 'name' => 'contact-button']) ?>
    <?php ActiveForm::end();?>

Yii连接数据库：
	配置文件目录db.php中，dsn配置项可选不同的数据库，Yii通过数据库访问对象，是建立在“PHP数据对象(PDO)”之上的。
		MySQL：mysql:host=localhost;dbname=mydatabase
		PostgreSQL:pgsql:host=localhost;port=5432;dbname=mydatabase
		Oracle:oci:dbname=//localhost:1521/mydatabase
数据库查询：
	1、通过command：
		$connection = Yii::$app->db;
        $sql = "select ... where id=:id";
        $command = $connection
        ->createCommand($sql)
		->bindValue('id',123)
        ->queryAll()/queryOne();
        $reg = Tools::array_column($command,'aaa','bbb');
        优点：
        	1、简单，只需处理SQL语句和数组即可
        	2、高效，通过SQL语句来查询数据库非常高效
        缺点：
        	1、不同数据库系统的SQL语句会有些差别，无法做到代码使用多种数据库系统
			2、用数组，没有用到面向对象的方式来管理数据，代码不好维护
			3、会存在SQL注入不安全因素
	2、ActiveRecord：
		一个AR类关联一张数据表，每个AR对象对应表中的一行
		AR对象的属性，对应数据库的列
		可以直接以面向对象的方式来操纵数据表中的数据，这样就不需要写SQL语句就能实现数据库的访问
		<span class="image featured"><img src="{{ 'assets/images/other/yiiaqi.jpg' | relative_url }}" alt="" /></span>
	3、findBySql：
		$sql = 'select ...';
		$re = Post::findBySql($sql)->all();
	4、QueryBuilder：
		$abc = (new \yii\db\Query())
			->select()
			->from()
			->where()
			->orderBy()
			->limit()
			->indexBy()
			->all();
	<span class="image featured"><img src="{{ 'assets/images/other/yiisqlquery.jpg' | relative_url }}" alt="" /></span>
小部件：
	注：view层字段名可以使用表对应的model文件中的属性名
	DetailView显示一条记录数据，ListView和GridView能够用于显示一个拥有分页，排序和过滤功能的一个列表或者表格
	<?= DetailView::widget([
        'model' => $model,
        'attributes' => [
            'id',
            ['label'=>'草','value'=>trim($model->name)],
            ['attribute'=>'email','format'=>'email','label'=>'邮箱箱'],
            ['attribute'=>'status','label'=>'状态'],
        ],
        'template'=>'html标签样式{label}{value}',
        'options'=>['class'=>'类样式'],
    ]) ?>    
    attributes中的属性
    <span class="image featured"><img src="{{ 'assets/images/other/yiidetailviewattrbute.jpg' | relative_url }}" alt="" /></span>
    template和options属性可以调节整个DetailView的格式

数组帮助类(Array Helper)：
	$value = $arr['key1']['key2']->name?arr['key1']['key2']->name:null;
	$value = ArrayHelper::getVaule($arr,'key1.key2.name');
	其他方法参考手册

<span class="image featured"><img src="{{ 'assets/images/other/yiiactivereoredlife.jpg' | relative_url }}" alt="" /></span>
</pre>