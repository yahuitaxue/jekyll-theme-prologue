---
title: DNS随手笔记
author: Yahui
layout: php
---

DNS知识点

1、hosts文件：以静态映射的方式提供IP地址与主机名的对照表，类似ARP表

2、域：abc.com是一个域，它可以划分为多个区域，如abc.com和xyz.abc.com


步骤

递归查询

第一步：在hosts静态文件、DNS解析器缓存中查找某主机的ip地址

第二步：上一步无法找到，去DNS本地服务器（即域服务器）查找，其本质是去区域服务器、服务器缓存中查找

第三步：本地DNS服务器查不到就根据‘根提示文件’向负责顶级域‘.com’的DNS服务器查询

第四步：‘根DNS服务器’根据查询域名中的‘xyz.com’，再向xyz.com的区域服务器查询

第五步：www.xyz.abc.com的DNS服务器直接解析该域名，将查询到的ip再原路返回给请求查询的主机


迭代查询

第一步：在hosts静态文件、DNS解析器缓存中查找某主机的ip地址

第二步：上一步无法找到，在DNS本地服务器（即域服务器）查找所有本层次的区域服务器

第三步：本地DNS服务器查不到就查询上一层次的所有区域服务器，以此类推直至根域名DNS服务器‘.’

第四步：到达根域名服务器后又向下查询，直至查到结果为止。


迭代查询与递归查询结合

递归查询需要经过逐层查询才能获得查询结果，当查询具有许多层次的DNS结构时效率很低，所以一般采用两者相结合的查询方式。

第一步：在hosts静态文件、DNS解析器缓存中查找某主机的ip地址

第二步：上一步无法找到，去DNS本地服务器（即域服务器）查找，其本质是去区域服务器、服务器缓存中查找

第三步：本地DNS服务器查不到就根据‘根提示文件’向负责顶级域‘.com’的根DNS服务器查询

第四步：根DNS服务器直接将其区域DNS服务器的ip地址返回给本地服务器，而不用再向xyz.com的区域服务器查询。

第五步：本地DNS服务器将结果返回给请求的主机

<span class="image left"><img src="{{ 'assets/images/other/dns.png' | relative_url }}" alt="" /></span>

例：www.123abc.com

Q1:查找本机浏览器缓存，或者本机hosts文件。

Q2:查找配置的dns服务器

Q3:运营商

Q4:查找运营商的服务器缓存

Q5:全球13台根域服务器(确认是.com域名)

Q6:去找顶级域名(.com)的服务器(确认是123abc.com)

Q7:找到就返回

Q8:去二级123abc.com的服务器(找到www.123abc.com对应的IP)

Q9:返回IP